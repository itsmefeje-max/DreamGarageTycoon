local player = game.Players.LocalPlayer
local ReplicatedStorage = game.ReplicatedStorage
local withdrawEvent = ReplicatedStorage:WaitForChild("WithdrawEvent")
-- Finds the input box even if it's inside a different frame, as long as it's a sibling or parent sibling
local mainWindow = script.Parent.Parent 
local input = mainWindow:FindFirstChild("AmountInput", true) 

script.Parent.MouseButton1Click:Connect(function()
	if not input then warn("Missing AmountInput") return end

	local text = input.Text:lower():gsub(",","") 

	if text == "all" or text == "max" then
		withdrawEvent:FireServer(player.leaderstats.Cash.Value)
		return
	end

	local multiplier = 1
	if text:match("k") then multiplier = 1000 end
	if text:match("m") then multiplier = 1000000 end

	local cleanNum = tonumber(text:match("[%d%.]+")) -- Fixed pattern to allow decimals like 1.5m

	if cleanNum then 
		local finalAmount = cleanNum * multiplier
		if finalAmount > 0 then
			withdrawEvent:FireServer(math.floor(finalAmount))
		end
	end
end)
